<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BIP85KMS Client-side Demo</title>
    <style>
      body { font-family: system-ui, sans-serif; margin: 2rem auto; max-width: 900px; padding: 0 1rem; }
      form { display: grid; gap: .75rem; }
      input, textarea, button { padding: .6rem; font: inherit; }
      textarea { min-height: 150px; font-family: monospace; font-size: 0.9em; }
      .warn { background: #fff7e6; border: 1px solid #ffd591; padding: .75rem; border-radius: 6px; margin-bottom: 1rem; }
      .info { background: #e6f7ff; border: 1px solid #91d5ff; padding: .75rem; border-radius: 6px; margin-bottom: 1rem; }
      pre { background: #f6f8fa; padding: 1rem; border-radius: 6px; overflow:auto; font-size: 0.9em; }
      .help-text { font-size: 0.9em; color: #656d76; margin-top: 0.25rem; }
      .button-row { display: flex; gap: 0.5rem; }
      button { flex: 1; }
      button.secondary { background: #f6f8fa; border: 1px solid #d0d7de; }
    </style>
    <script type="importmap">
      {
        "imports": {
          "@scure/bip32": "https://esm.sh/@scure/bip32@1.6.2",
          "@scure/bip39": "https://esm.sh/@scure/bip39@1.5.4",
          "@noble/hashes/sha256": "https://esm.sh/@noble/hashes@1.7.1/sha256",
          "@noble/hashes/hmac": "https://esm.sh/@noble/hashes@1.7.1/hmac",
          "@noble/hashes/argon2": "https://esm.sh/@noble/hashes@1.7.1/argon2",
          "@noble/curves/ed25519": "https://esm.sh/@noble/curves@1.8.2/ed25519",
          "bech32": "https://esm.sh/bech32@2.0.0"
        }
      }
    </script>
  </head>
  <body>
    <h1>BIP85KMS â€” Semantic Path Derivation</h1>
    <p>Derive Age encryption keys from semantic paths using BIP-Keychain specification.</p>
    
    <div class="warn">
      <strong>Warning:</strong> The mnemonic entered here is sensitive. Use only for local testing and only in trusted environments.
    </div>

    <div class="info">
      <strong>BIP-Keychain Semantic Paths:</strong> Instead of arbitrary numbers, derivation paths are built from meaningful JSON-LD objects using schema.org vocabulary. Each segment must have an <code>@type</code> property.
    </div>

    <form id="derive-form">
      <label>
        Mnemonic
        <textarea id="mnemonic" required placeholder="bacon bacon bacon bacon ..."></textarea>
      </label>

      <label>
        Semantic Path (JSON-LD array of objects)
        <textarea id="semanticPath" required placeholder='[
  {
    "@type": "Organization",
    "name": "AcmeCorp"
  },
  {
    "@type": "SoftwareApplication",
    "name": "backup-system"
  },
  {
    "@type": "DigitalDocument",
    "name": "database.sql"
  }
]'></textarea>
        <div class="help-text">
          Enter an array of JSON-LD objects with schema.org types. Common types: Organization, SoftwareApplication, DigitalDocument, WebSite, Person.
        </div>
      </label>

      <label>
        <input id="getPrivateKey" type="checkbox" checked /> Include private key material
      </label>

      <div class="button-row">
        <button type="button" class="secondary" id="example-btn">Load Example</button>
        <button type="submit">Derive Keys</button>
      </div>
    </form>

    <h2>Result</h2>
    <pre id="output">Enter a mnemonic and semantic path, then click "Derive Keys".</pre>

    <script type="module" src="./web/app.js"></script>
  </body>
</html>
